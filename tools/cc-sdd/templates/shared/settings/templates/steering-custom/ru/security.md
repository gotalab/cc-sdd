# Стандарты безопасности

[Назначение: определить позицию безопасности с паттернами для валидации, авторизации, секретов и данных]

## Философия
- Эшелонированная защита; минимальные привилегии; безопасность по умолчанию; fail closed
- Валидация на границах; санитизация по контексту; никогда не доверять вводу
- Разделение аутентификации (кто) и авторизации (что)

## Ввод и Вывод
- Валидировать на границах API и UI формах; применять типы и ограничения
- Санитизировать/экранировать по назначению (HTML, SQL, shell, логи)
- Предпочитать allow-lists над block-lists; отклонять рано с минимальными деталями

## Аутентификация и Авторизация
- Аутентификация: проверить идентичность; выдать короткоживущие токены/сессии
- Авторизация: проверять разрешения перед действиями; запрет по умолчанию
- Централизовать политики; избегать дублирования проверок по коду

Паттерн:
```typescript
if (!user.hasPermission('resource:action')) throw ForbiddenError();
```

## Секреты и Конфигурация
- Никогда не коммитить секреты; хранить в secret manager или env
- Ротировать регулярно; аудитировать доступ; минимальный scope
- Валидировать обязательные env vars при запуске; fail fast при отсутствии

## Чувствительные данные
- Минимизировать сбор; маскировать/редактировать в логах; шифровать at rest и in transit
- Ограничивать доступ по роли/need-to-know; отслеживать доступ к чувствительным записям

## Безопасность сессий/токенов
- httpOnly + secure cookies где возможно; TLS везде
- Короткое истечение; ротировать при refresh; отзывать при logout/компрометации
- Привязывать токены к audience/issuer; минимальные claims

## Логирование (security-aware)
- Логировать попытки auth, отказы в разрешениях, чувствительные операции
- Никогда не логировать пароли, токены, секреты, полные PII; избегать полных тел
- Включать requestId и контекст для корреляции событий

## Заголовки и Транспорт
- Обязательный TLS; HSTS
- Установить security headers (CSP, X-Frame-Options, X-Content-Type-Options)
- Предпочитать современную криптографию; отключить слабые протоколы/шифры

## Позиция по уязвимостям
- Предпочитать безопасные библиотеки; держать зависимости обновлёнными
- Статические/динамические сканы в CI; отслеживать и устранять
- Обучать команду распространённым классам; кодировать как паттерны выше

---
_Фокус на паттернах и принципах. Ссылки на конкретные конфиги в ops docs._
