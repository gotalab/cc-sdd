description = "Инициализировать новую спецификацию с описанием проекта"
prompt = """
<meta>
description: Инициализировать новую спецификацию с описанием проекта
argument-hint: <описание-проекта:$ARGUMENTS>
arguments: {{args}}
</meta>

# Инициализация спецификации

<background_information>
- **Миссия**: Инициализировать первую фазу spec-driven разработки, создав структуру каталогов и метаданные для новой спецификации
- **Критерии успеха**:
  - Сгенерировать подходящее имя функции из описания проекта
  - Создать уникальную структуру спецификации без конфликтов
  - Указать чёткий путь к следующей фазе (генерация требований)
</background_information>

<instructions>
## Основная задача
Сгенерировать уникальное имя функции из описания проекта ($ARGUMENTS) и инициализировать структуру спецификации.

## Шаги выполнения
1. **Проверить уникальность**: Проверить `{{KIRO_DIR}}/specs/` на конфликты имён (добавить числовой суффикс при необходимости)
2. **Создать каталог**: `{{KIRO_DIR}}/specs/[имя-функции]/`
3. **Инициализировать файлы по шаблонам**:
   - Прочитать `{{KIRO_DIR}}/settings/templates/specs/init.json`
   - Прочитать `{{KIRO_DIR}}/settings/templates/specs/requirements-init.md`
   - Заменить placeholder'ы:
     - `{{FEATURE_NAME}}` → сгенерированное имя функции
     - `{{TIMESTAMP}}` → текущая метка времени ISO 8601
     - `{{PROJECT_DESCRIPTION}}` → $ARGUMENTS
   - Записать `spec.json` и `requirements.md` в каталог спецификации

## Важные ограничения
- НЕ генерировать требования/дизайн/задачи на этом этапе
- Следовать принципам поэтапной разработки
- Соблюдать строгое разделение фаз
- На этой фазе выполняется только инициализация
</instructions>

## Руководство по инструментам
- Использовать **Glob** для проверки существующих каталогов спецификаций на уникальность имени
- Использовать **Read** для получения шаблонов: `init.json` и `requirements-init.md`
- Использовать **Write** для создания spec.json и requirements.md после замены placeholder'ов
- Выполнять валидацию перед любой операцией записи

## Описание вывода
Предоставить вывод на языке, указанном в `spec.json`, со следующей структурой:

1. **Сгенерированное имя функции**: формат `имя-функции` с обоснованием в 1-2 предложения
2. **Краткое описание проекта**: Краткое резюме (1 предложение)
3. **Созданные файлы**: Маркированный список с полными путями
4. **Следующий шаг**: Блок кода с командой `/kiro:spec-requirements <имя-функции>`
5. **Примечания**: Объяснить, почему выполнена только инициализация (2-3 предложения о разделении фаз)

**Требования к формату**:
- Использовать заголовки Markdown (##, ###)
- Команды оборачивать в блоки кода
- Общий вывод должен быть кратким (менее 250 слов)
- Использовать ясный, профессиональный язык согласно `spec.json.language`

## Безопасность и Fallback
- **Неоднозначное имя функции**: Если генерация имени неясна, предложить 2-3 варианта и попросить пользователя выбрать
- **Отсутствует шаблон**: Если файлы шаблонов не существуют в `{{KIRO_DIR}}/settings/templates/specs/`, сообщить об ошибке с указанием отсутствующего файла
- **Конфликт каталогов**: Если имя функции уже существует, добавить числовой суффикс (например, `имя-функции-2`)
- **Ошибка записи**: Сообщить об ошибке с указанием пути

arguments: {{args}}
"""
